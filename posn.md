## Краткое описание алгоритма PoS<sup>n</sup> 

### 

> Для того чтобы подробно описать описать все детали и математику  метода нужно больше места. 
> Пока ограничимся кратким анонсом для понимания сути процесса.


Для поддержания целостности данных распределенного блокчейна и реализации алгоритма консенсуса необходимо создавать связный граф транзакций. Для этого _нода_ связывает каждую транзакцию с ,блокчейном с помощью ссылок: 



*   с одной стороны: на адрес IPFS своей  последней транзакции, которая в свою очередь связана с предыдущей, 
*   и с другой:  с адресом IPFS пакетов - (иx может быть несколько), которые прислали другие ноды, нуждающиеся в   валидации своих транзакций в приватном разделе файловой системы INBOX. 

На выходе мы получаем логическую структуру в виде графа. Данная форма не реляционного представления данных носит название DAG (направленный ациклический граф). Вершины его или узлы всегда “моложе” тех, на которые он ссылается.

Кроме эффектной архитектуры данных мы получаем возможность валидировать наши исторические данные при подсчете баланса, что так необходимо при подсчете баланса и отправке транзакций. 

Ключевым игроком здесь является связь с  соседней веткой, или branch транзакцией, которую нужно валидировать, чтобы создать свою.  Данная транзакция тоже в свою очередь содержит такие же ссылки. 

Валидация brunch позволяет достигнуть нескольких целей:
*   Проверяет ее на наличие возможного мошенничества сравнением балансов в дереве,
*   Делает намерения ноды валидатора известными сети и повышает его рейтинг.

На словах алгоритм можно описать так:
*   Нода начинает итеративно подсчитывать операционный баланс по счету branch транзакции по ее trunk ссылкам, используя скорости IPLD,
*   Одновременно с каждым шагом, она проверяет наличие в своей цепи trunk наличие адреса транзакции, совпадающего с текущим шагом в brunch,
*   Как только адреса и их операционные балансы совпадут - валидация успешна, и в качестве доказательства вместе с адресом branch в транзакции, указывается адрес транзакции, на которой валидация произошла. 
*   Если совпадения нет до генезиса, то скорее всего транзакция мошенническая и ссылка на нее удаляется из INBOX, не валидируется и не используется для собственной  валидации.

Теперь, после публикации, модуль кошелька любой ноды может проверить баланс входящей транзакции не только по отправителю но и по его валидациям. Опыт аналогичных систем хранения (IOTA, например) показал, что ближайшее совпадение происходит не далее 15-ой итерации.